import os
import discord
from config.rootdir import root_dir
import datetime

# 1.3.1 최고 레벨
final_lv = 300

# 1.3.2 앰블럼 이름 데이터
arr_emblem = [[
    'Initial', 'Scarlet', 'Amber', 'Topaz', 'Chlorophyll', 'Aquatic',
    'Sapphire', 'Violette', 'Holy', 'Ultimate'
],
              [
                  'Square', 'Ring', 'Trigon', 'Stelle', 'Hexagon', 'Diamond',
                  'Hexagram', 'Insignia', 'Plasma', 'Collar', 'Cardioid',
                  'Fluid', 'Flame', 'Bolt', 'Solarus', 'Polyphemus', 'Spiral',
                  'Physis', 'Elementum', 'Nebula', 'Lumine', 'Crystal', 'Custos', 'Iustitia',
                  'Loyal', 'Expert', 'Liberum', 'God', 'Master', 'Legendary'
              ]]

emblem_icon = [
        "<:1_:1216683120724545556>",
        "<:2_:1216683122272370748>",
        "<:3_:1216683124231241810>",
        "<:4_:1216683126026141806>",
        "<:5_:1216683128085544960>",
        "<:6_:1216683129658540067>",
        "<:7_:1216683131629862993>",
        "<:8_:1216683134104375296>",
        "<:9_:1216683146649538640>",
        "<:10:1216683148805406782>",
        "<:11:1216683150843842600>",
        "<:12:1216683152488136745>",
        "<:13:1216683154652266566>",
        "<:14:1216683156640497745>",
        "<:15:1216683159492628500>",
        "<:16:1216683161166282752>",
        "<:17:1216683163254784050>",
        "<:18:1216683164962000966>",
        "<:19:1216683167105159280>",
        "<:20:1216683543464247327>",
        "<:21:1216683171303653437>",
        "<:22:1216683176332623966>",
        "<:23:1216683178320986212>",
        "<:24:1216683546261848205>",
        "<:25:1216683182603374592>",
        "<:26:1216683185992368138>",
        "<:27:1216683188747767918>",
        "<:28:1216683192094822470>",
        "<:29:1216683196716945559>",
        "<:30:1216683198625353859>",
        "<:31:1216683548237365278>",
        "<:32:1216683203377631372>",
        "<:33:1216683206938591262>",
        "<:34:1216683209887060048>",
        "<:35:1216683213024657538>",
        "<:36:1216683555720134680>",
        "<:37:1216683217197727786>",
        "<:38:1216683219106267217>",
        "<:39:1216683558211682315>",
        "<:40:1216683224001155142>",
        "<:41:1216683227209666671>",
        "<:42:1216683230292607096>",
        "<:43:1216683233245139024>",
        "<:44:1216683560149323908>",
        "<:45:1216683237552947272>",
        "<:46:1216683562099802224>",
        "<:47:1216683241780805642>",
        "<:48:1216683244075090031>",
        "<:49:1216683563953553408>",
        "<:50:1216683248776777768>",
        "<:51:1216684852976291860>",
        "<:52:1216684854687563836>",
        "<:53:1216684856562552942>",
        "<:54:1216684858315640873>",
        "<:55:1216684860173979668>",
        "<:56:1216684862166142986>",
        "<:57:1216684864594509885>",
        "<:58:1216684866524151858>",
        "<:59:1216684868491153408>",
        "<:60:1216684870365876265>",
        "<:61:1216685023508303963>",
        "<:62:1216685025853046834>",
        "<:63:1216685027698409502>",
        "<:64:1216685029900423208>",
        "<:65:1216685032190771240>",
        "<:66:1216685034413756436>",
        "<:67:1216685036351524874>",
        "<:68:1216685038125711381>",
        "<:69:1216685040679784468>",
        "<:70:1216685042676531240>",
        "<:71:1216685193113501756>",
        "<:72:1216685195328094239>",
        "<:73:1216685197219729408>",
        "<:74:1216685199291846666>",
        "<:75:1216685200818438175>",
        "<:76:1216685202974441472>",
        "<:77:1216685204685717514>",
        "<:78:1216685207634182215>",
        "<:79:1216685209420824596>",
        "<:80:1216685212562624593>",
        "<:81:1216685532973891584>",
        "<:82:1216685534764863498>",
        "<:83:1216685536987578398>",
        "<:84:1216685539252506696>",
        "<:85:1216685541307842581>",
        "<:86:1216685543182827520>",
        "<:87:1216685545007353917>",
        "<:88:1216685546915758100>",
        "<:89:1216685549058920488>",
        "<:90:1216685551315456051>",
        "<:91:1216685552678731918>",
        "<:92:1216685555744509962>",
        "<:93:1216685557749645352>",
        "<:94:1216685559561588746>",
        "<:95:1216685650460540979>",
        "<:96:1216685652645646406>",
        "<:97:1216685654487076904>",
        "<:98:1216685656705863720>",
        "<:99:1216685659033702411>",
        "<:100:1216685661042769960>",
        "<:101:1216687472130658346>",
        "<:102:1216687473816637481>",
        "<:103:1216687477239320606>",
        "<:104:1216687479873077369>",
        "<:105:1216687483287375995>",
        "<:106:1216687486282108948>",
        "<:107:1216687487846711400>",
        "<:108:1216687491583705188>",
        "<:109:1216687493550702612>",
        "<:110:1216687496214220821>",
        "<:111:1216687771649966140>",
        "<:112:1216687774472867882>",
        "<:113:1216687777555415142>",
        "<:114:1216687780114071624>",
        "<:115:1216687783285100624>",
        "<:116:1216687785373601902>",
        "<:117:1216687787575742464>",
        "<:118:1216687789673021520>",
        "<:119:1216687792080551986>",
        "<:120:1216687794433560576>",
        "<:121:1216688041758818335>",
        "<:122:1216688044531253359>",
        "<:123:1216688046632734760>",
        "<:124:1216688049056911400>",
        "<:125:1216688051552518164>",
        "<:126:1216688054283145217>",
        "<:127:1216688056153800757>",
        "<:128:1216688058326323211>",
        "<:129:1216688060167749713>",
        "<:130:1216688062332014652>",
        "<:131:1216688193995280415>",
        "<:132:1216688196692213890>",
        "<:133:1216688198839832586>",
        "<:134:1216688201050095696>",
        "<:135:1216688203134668893>",
        "<:136:1216688206590775376>",
        "<:137:1216688209228988457>",
        "<:138:1216688210487545887>",
        "<:139:1216688213578485820>",
        "<:140:1216688215239557162>",
        "<:141:1216688305031221298>",
        "<:142:1216688307505729536>",
        "<:143:1216688310177501287>",
        "<:144:1216688312010539078>",
        "<:145:1216688314178998346>",
        "<:146:1216688316989308989>",
        "<:147:1216688320046829679>",
        "<:148:1216688323796406345>",
        "<:149:1216688327181467709>",
        "<:150:1216688329119105084>",
        "<:151:1216688631666835556>",
        "<:152:1216688633851940905>",
        "<:153:1216688636263927878>",
        "<:154:1216688639086563329>",
        "<:155:1216688642341470278>",
        "<:156:1216688644488957952>",
        "<:157:1216688647408058368>",
        "<:158:1216688649106755624>",
        "<:159:1216688657864462367>",
        "<:160:1216688660284571660>",
        "<:161:1216688800575524875>",
        "<:162:1216688802266091530>",
        "<:163:1216688805558484992>",
        "<:164:1216688808217804921>",
        "<:165:1216688810264625182>",
        "<:166:1216688812185489429>",
        "<:167:1216688814106607636>",
        "<:168:1216688817122050129>",
        "<:169:1216688818963349545>",
        "<:170:1216688820964167690>",
        "<:171:1216688959699030046>",
        "<:172:1216688962853404702>",
        "<:173:1216688966569426955>",
        "<:174:1216688968951922778>",
        "<:175:1216688971204001873>",
        "<:176:1216688973364199504>",
        "<:177:1216688975633322024>",
        "<:178:1216688978196041818>",
        "<:179:1216688980708429865>",
        "<:180:1216688983237591081>",
        "<:181:1216689133855182929>",
        "<:182:1216689135633301514>",
        "<:183:1216689137944629298>",
        "<:184:1216689140033388594>",
        "<:185:1216689141954248724>",
        "<:186:1216689144185487410>",
        "<:187:1216689146240700526>",
        "<:188:1216689149466116126>",
        "<:189:1216689151353688085>",
        "<:190:1216689152947388417>",
        "<:191:1216689269217951874>",
        "<:192:1216689270950199317>",
        "<:193:1216689273583960165>",
        "<:194:1216689276037758986>",
        "<:195:1216689278784897054>",
        "<:196:1216689279934398485>",
        "<:197:1216689282270363788>",
        "<:198:1216689330978947102>",
        "<:199:1216689332702679091>",
        "<:200:1216689334535716915>",
        "<:201:1216689789756248085>",
        "<:202:1216689792339804240>",
        "<:203:1216689794638413884>",
        "<:204:1216689796768862270>",
        "<:205:1216689798907957329>",
        "<:206:1216689800996982784>",
        "<:207:1216689802754129961>",
        "<:208:1216689805031768104>",
        "<:209:1216689806927597619>",
        "<:210:1216689808659841024>",
        "<:211:1216689934799339570>",
        "<:212:1216689936565014528>",
        "<:213:1216689938373017731>",
        "<:214:1216689939987693588>",
        "<:225:1216690071537713183>",
        "<:216:1216689943309586504>",
        "<:217:1216689945716981791>",
        "<:218:1216689947520794704>",
        "<:219:1216689950016147516>",
        "<:220:1216689951954047009>",
        "<:221:1216690060548640788>",
        "<:222:1216690064839409696>",
        "<:223:1216690067364515840>",
        "<:224:1216690069793017856>",
        "<:225:1216690071537713183>",
        "<:226:1216690073727275018>",
        "<:227:1216690075526762506>",
        "<:228:1216690077510668369>",
        "<:229:1216690080413126688>",
        "<:230:1216690082891956324>",
        "<:231:1216690186495197214>",
        "<:232:1216690188810457169>",
        "<:233:1216690190626721872>",
        "<:234:1216690192522543154>",
        "<:235:1216690195655688192>",
        "<:236:1216690197832405112>",
        "<:237:1216690199724167251>",
        "<:238:1216690201477382215>",
        "<:239:1216690203830255626>",
        "<:240:1216690205633937429>",
        "<:241:1216690263368400978>",
        "<:242:1216690265171951726>",
        "<:243:1216690266610597888>",
        "<:244:1216690268259094570>",
        "<:245:1216690269974691881>",
        "<:246:1216690272059265104>",
        "<:247:1216690273795440681>",
        "<:248:1216690275704115210>",
        "<:249:1216690277415256074>",
        "<:250:1216690279151566858>",
        "<:251:1216689410893021315>",
        "<:252:1216689412558290974>",
        "<:253:1216689414210588672>",
        "<:254:1216689415997620234>",
        "<:255:1216689417608101888>",
        "<:256:1216689419344678933>",
        "<:257:1216689420590125149>",
        "<:258:1216689422569963540>",
        "<:259:1216689424394616943>",
        "<:260:1216689426118344724>",
        "<:261:1216689515079667773>",
        "<:262:1216689430128099388>",
        "<:263:1216689432753864795>",
        "<:264:1216689516639948850>",
        "<:265:1216689436616822835>",
        "<:266:1216689439485591572>",
        "<:267:1216689518632239184>",
        "<:268:1216689443604402256>",
        "<:269:1216689541692526632>",
        "<:270:1216689447920205874>",
        "<:271:1216689578694541395>",
        "<:272:1216689581307596910>",
        "<:273:1216689582981124166>",
        "<:274:1216689585397043351>",
        "<:275:1216689586991005870>",
        "<:276:1216689590052847767>",
        "<:277:1216689592296538183>",
        "<:278:1216689593945165845>",
        "<:279:1216689596583247953>",
        "<:280:1216689598458232852>",
        "<:281:1216693695638798496>",
        "<:282:1216693697798869072>",
        "<:283:1216693699787100160>",
        "<:284:1216693701666017300>",
        "<:285:1216693704195051520>",
        "<:286:1216693706061643797>",
        "<:287:1216693708897128508>",
        "<:288:1216693710834630656>",
        "<:289:1216693712856285214>",
        "<:290:1216693714517491792>",
        "<:291:1216693742015086592>",
        "<:292:1216693744015900711>",
        "<:293:1216693745890627665>",
        "<:294:1216693747849498674>",
        "<:295:1216693750584053841>",
        "<:296:1216693752593383497>",
        "<:297:1216693754480820304>",
        "<:298:1216693756703543306>",
        "<:299:1216693758444175420>",
        "<:300:1216693760998641684>"
    ]


# 1.3.3 경험치 데이터
def xpList():
    file = open(root_dir + "/config/xp.txt", "r")
    arr = []
    line = file.readline()
    arr.append(line.rstrip('\n'))
    while line:
        try:
            line = file.readline().rstrip('\n')
            arr.append(int(line))
        except:
            break
    file.close()
    return arr


xp_arr = xpList()
max_xp = xp_arr[final_lv - 1]

# 2.3. 경험치 관련


# 2.3.1 최고 레벨 출력
def maxLevel():
    return final_lv


# 2.3.2 정수 레벨 출력
def level(exp):
    if exp > max_xp:
        return final_lv
    else:
        i = 1
        while (1):
            if exp < xp_arr[i]:
                break
            else:
                i += 1
        return i


# 2.3.3. Required XP
def need_exp(i):
    return int(xp_arr[i])


# 2.3.4. Level Up (Boolean)
def level_up(temp, pres):
    if temp > final_lv:
        return False
    else:
        if need_exp(temp) <= pres:
            return True
        else:
            return False


# 2.3.5. emblem name
def emblemName(lv):
    return "{} {} Emblem".format(arr_emblem[0][int((lv - 1) % 10)],
                                 arr_emblem[1][int((lv - 1) / 10)])

def lvicon(lv):
    return emblem_icon[lv-1]


def checkBox(s):
    if s == 0:
        return ":black_large_square:"
    elif s == 1:
        return ":white_check_mark:"
    else:
        return ":question:"

# 2.3.6. Bar
def process_bar(ratio, length = 10):

    xpBar = ["<:bar0:1216622427992227980>", "<:bar1:1216622429934190633>", "<:bar2:1216622432069226617>", "<:bar3:1216622433637892096>", "<:bar4:1216622435902947358>", "<:bar5:1216622437756702720>", "<:bar6:1216622439727890482>", "<:bar7:1216622441502343218>", "<:bar8:1216622443427270677>", "<:bar9:1216622445151129640>", "<:bara:1216622446740901968>"]
    cons = int((ratio*10*length)//10)
    detail = int((ratio*10*length)%10)
    str_process = xpBar[10] * cons + xpBar[detail] + xpBar[0] * (length - cons - 1)
    return str_process


# 2.2. Storage List Read
def storageLineRead(option:str = None):
    file = open(root_dir + "/config/storage.txt", "r", encoding='UTF8')
    temp = []
    for data in file.readlines():
        line = data.split(" - ")
        print(line)

        if option == 'all':
            temp.append(line[:5])
        else:
            if line[5].replace("\n", "") == option:
                temp.append(line[:5])

    return temp


# 2.3. voice
def voiceRead(user: discord.Member = None):
    file = open(root_dir + "/data/voice/" + str(user.id) + ".txt", "r+")
    if file != None:
        return int(file.read())
    else:
        pass
    file.close()


def voiceWrite(user: discord.Member = None, value: int = None):
    file = open(root_dir + "/data/voice/" + str(user.id) + ".txt", "w+")
    if file == None:
        pass
    file.write(str(value))
    file.close()


def voiceDelete(user: discord.Member = None):
    file = root_dir + "/data/voice/" + str(user.id) + ".txt"
    if os.path.isfile(file):
        os.remove(file)


# 2.4.3. Number Font
def numFont(i):
    #old
    num = [
        "<:g0:1216696457164492872>","<:g1:1216696459261640785>",
        "<:g2:1216696461551730810>","<:g3:1216696463300497498>",
        "<:g4:1216696466400350228>","<:g5:1216696468610613249>",
        "<:g6:1216696470712094723>","<:g7:1216696473459097630>",
        "<:g8:1216696475388743750>","<:g9:1216696478584672306>"
    ]
    result = ''
    for c in str(i):
        result += num[int(c)]
    return result


# 2.4.5. uid Extract
def extractUid(author):
    return int(author[2:][:-1])


# Times until end of day
def endOfDate(dt=None):

    if dt is None:
        dt = datetime.datetime.now()

    h = 24 - dt.hour
    m = (-1) * dt.minute
    s = (-1) * dt.second

    if s < 0:
        s += 60
        m -= 1

    if m < 0:
        m += 60
        h -= 1

    return f"{str(h).zfill(2)}h {str(m).zfill(2)}m {str(s).zfill(2)}s"

def endOfDateSeconds(dt=None):
    if dt is None:
        dt = datetime.datetime.now()
    return ((24 - dt.hour - 1) * 60 * 60) + ((60 - dt.minute - 1) * 60) + (60 - dt.second)
